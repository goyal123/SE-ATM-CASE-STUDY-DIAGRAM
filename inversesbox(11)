#include<stdio.h>
int bin[4]={0,0,0,0};
void convert_hextobin(char x)
{
 switch(x)
 {
  case '0':bin[0]=0;
           bin[1]=0;
           bin[2]=0;
           bin[3]=0;
           break;
  case '1':bin[0]=0;
           bin[1]=0;
           bin[2]=0;
           bin[3]=1;
           break;
  case '2':bin[0]=0;
           bin[1]=0;
           bin[2]=1;
           bin[3]=0;
           break;
  case '3':bin[0]=0;
           bin[1]=0;
           bin[2]=1;
           bin[3]=1;
           break;
  case '4':bin[0]=0;
           bin[1]=1;
           bin[2]=0;
           bin[3]=0;
           break;
  case '5':bin[0]=0;
           bin[1]=1;
           bin[2]=0;
           bin[3]=1;
           break;
  case '6':bin[0]=0;
           bin[1]=1;
           bin[2]=1;
           bin[3]=0;
           break;
  case '7':bin[0]=0;
           bin[1]=1;
           bin[2]=1;
           bin[3]=1;
           break;
  case '8':bin[0]=1;
           bin[1]=0;
           bin[2]=0;
           bin[3]=0;
           break;
  case '9':bin[0]=1;
           bin[1]=0;
           bin[2]=0;
           bin[3]=1;
           break;
  case 'a':bin[0]=1;
           bin[1]=0;
           bin[2]=1;
           bin[3]=0;
           break;
  case 'b':bin[0]=1;
           bin[1]=0;
           bin[2]=1;
           bin[3]=1;
           break;
  case 'c':bin[0]=1;
           bin[1]=1;
           bin[2]=0;
           bin[3]=0;
           break;
  case 'd':bin[0]=1;
           bin[1]=1;
           bin[2]=0;
           bin[3]=1;
           break;
  case 'e':bin[0]=1;
           bin[1]=1;
           bin[2]=1;
           bin[3]=0;
           break;
  case 'f':bin[0]=1;
           bin[1]=1;
           bin[2]=1;
           bin[3]=1;
           break;
 }
}

int convert_bintohex(int x,int y)
{
 int temp;
 temp=y*1;
 temp=temp+x*2;
 return temp;
}

char convert_dectohex(int x,int y) //convert dec x n y to binary and convert entire binary to hexa
{
 int a[4]={0,0,0,0},b=0;
 char p,b1;
 switch(x)
 {
  case 0: a[0]=0;
          a[1]=0;
          break;
  case 1: a[0]=0;
          a[1]=1;
          break;
  case 2: a[0]=1;
          a[1]=0;
          break;
  case 3: a[0]=1;
          a[1]=1;
          break;
 }
 switch(y)
 {
  case 0: a[2]=0;
          a[3]=0;
          break;
  case 1: a[2]=0;
          a[3]=1;
          break;
  case 2: a[2]=1;
          a[3]=0;
          break;
  case 3: a[2]=1;
          a[3]=1;
          break;
 }
 b=1*a[3];
 b=b+2*a[2];
 b=b+4*a[1];
 b=b+8*a[0];
 b1=b+'0';
 if(b>9)
 {
  switch(b)
  {
   case 10: b1='a';
            break;
   case 11: b1='b';
            break;
   case 12: b1='c';
            break;
   case 13: b1='d';
            break;
   case 14: b1='e';
            break;
   case 15: b1='f';
            break;
  }
 }
 return b1;
}

main()
{
 int i,j,p,q;
 char x,s[4][4]={0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},new_s[4][4]={0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0};
 s[0][0]='9';
 s[0][1]='4';
 s[0][2]='a';
 s[0][3]='b';
 s[1][0]='d';
 s[1][1]='1';
 s[1][2]='8';
 s[1][3]='5';
 s[2][0]='6';
 s[2][1]='2';
 s[2][2]='0';
 s[2][3]='3';
 s[3][0]='c';
 s[3][1]='e';
 s[3][2]='f';
 s[3][3]='7';
 printf("\nSimplified S-box of AES:\n\n");
 for(i=0;i<4;i++)
 {
  for(j=0;j<4;j++)
  {
   printf("%c\t",s[i][j]);
  }
  printf("\n");
 }
 printf("\n\nInverse of S-box of AES:\n\n");
 for(i=0;i<4;i++)
 {
  for(j=0;j<4;j++)
  {
   x=s[i][j];
   convert_hextobin(x);
   p=convert_bintohex(bin[0],bin[1]);
   q=convert_bintohex(bin[2],bin[3]);
   new_s[p][q]=convert_dectohex(i,j);
  }
 }
 for(i=0;i<4;i++)
 {
  for(j=0;j<4;j++)
  {
   printf("%c\t",new_s[i][j]);
  }
  printf("\n");
 }
 printf("\n");
}
